import{c as k,d as h,i as m,n as $,u as e,B as C,x as D,o as d,g as n,r as _,l as at,f as s,e as a,p as lt,b as x,h as l,t as v,j as R,F as nt,q as ot,H as y}from"./index-dncQmnLB.js";import{a as rt}from"./auth-BFT6Wqoc.js";import{e as P,_ as S,g as dt,R as ut,d as T,a as I,b as N,c as U,f as it,h as ct,r as ft,u as mt,i as pt}from"./DialogTitle.vue_vue_type_script_setup_true_lang-DGdUbv8h.js";import{_ as f,c as O,b as q,d as F,a as vt}from"./_plugin-vue_export-helper-DER20O5o.js";const _t=k("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);const yt=k("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);const xt=k("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);const ht=k("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);const bt=k("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);const gt=k("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);const wt=k("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),J=h({__name:"DialogFooter",props:{class:{}},setup(c){const i=c;return(u,p)=>(d(),m("div",{"data-slot":"dialog-footer",class:$(e(C)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",i.class))},[D(u.$slots,"default")],2))}}),kt={"data-slot":"table-container",class:"relative w-full overflow-auto"},$t=h({__name:"Table",props:{class:{}},setup(c){const i=c;return(u,p)=>(d(),m("div",kt,[n("table",{"data-slot":"table",class:$(e(C)("w-full caption-bottom text-sm",i.class))},[D(u.$slots,"default")],2)]))}}),Ct=h({__name:"TableBody",props:{class:{}},setup(c){const i=c;return(u,p)=>(d(),m("tbody",{"data-slot":"table-body",class:$(e(C)("[&_tr:last-child]:border-0",i.class))},[D(u.$slots,"default")],2))}}),w=h({__name:"TableCell",props:{class:{}},setup(c){const i=c;return(u,p)=>(d(),m("td",{"data-slot":"table-cell",class:$(e(C)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",i.class))},[D(u.$slots,"default")],2))}}),H=h({__name:"TableRow",props:{class:{}},setup(c){const i=c;return(u,p)=>(d(),m("tr",{"data-slot":"table-row",class:$(e(C)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",i.class))},[D(u.$slots,"default")],2))}}),E=h({__name:"TableHead",props:{class:{}},setup(c){const i=c;return(u,p)=>(d(),m("th",{"data-slot":"table-head",class:$(e(C)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",i.class))},[D(u.$slots,"default")],2))}}),Dt=h({__name:"TableHeader",props:{class:{}},setup(c){const i=c;return(u,p)=>(d(),m("thead",{"data-slot":"table-header",class:$(e(C)("[&_tr]:border-b",i.class))},[D(u.$slots,"default")],2))}}),Et={class:"min-h-screen bg-gray-50"},At={class:"bg-white shadow-sm border-b"},Lt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},Mt={class:"flex justify-between items-center"},Rt={class:"flex items-center space-x-4"},jt={class:"flex items-center space-x-4"},Bt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},zt={class:"mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},Vt={class:"flex gap-2"},Ht={class:"overflow-x-auto"},Pt={class:"font-medium"},St={class:"text-sm text-gray-500 hidden xl:block"},Tt={class:"flex gap-2"},It={class:"space-y-4"},Nt={class:"flex items-center justify-center w-full"},Ut={for:"file-upload",class:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100"},Ot={class:"flex flex-col items-center justify-center pt-5 pb-6"},qt={key:0,class:"mt-2 text-sm text-gray-700"},Ft={key:0},Jt={key:1},Gt=h({__name:"AdminView",setup(c){const i=lt(),u=_([]),p=_(!1),j=_(""),A=_(!1),b=_(null),B=_(!1),L=_(""),M=_(!1),z=_(""),g=async()=>{p.value=!0,j.value="";try{const o=await dt();u.value=o.data.data||[]}catch(o){j.value=o.message||"加载插件列表失败"}finally{p.value=!1}},G=async o=>{try{await it(o),await g(),y.success("插件已启用")}catch(t){y.error(t.message||"启用插件失败")}},K=async o=>{try{await ct(o),await g(),y.success("插件已禁用")}catch(t){y.error(t.message||"禁用插件失败")}},Q=async o=>{try{await ft(o),await g(),y.success("插件已重载")}catch(t){y.error(t.message||"重新加载插件失败")}},W=o=>{z.value=o,M.value=!0},X=async()=>{const o=z.value;M.value=!1;try{await mt(o),await g(),y.success("插件已卸载")}catch(t){y.error(t.message||"卸载插件失败")}},Y=o=>{const t=o.target;t.files&&t.files.length>0&&(b.value=t.files[0]||null,L.value="")},Z=async()=>{if(b.value){B.value=!0,L.value="";try{await pt(b.value),A.value=!1,b.value=null,await g(),y.success("插件上传成功")}catch(o){L.value=o.message||"上传插件失败"}finally{B.value=!1}}},tt=async()=>{try{await rt()}catch{}finally{localStorage.removeItem("isAuthenticated"),i.push("/login")}},et=o=>{switch(o){case"ENABLED":return"default";case"LOADED":return"secondary";case"DISABLED":return"outline";case"ERROR":return"destructive";default:return"secondary"}},st=o=>{switch(o){case"ENABLED":return"已启用";case"LOADED":return"已加载";case"DISABLED":return"已禁用";case"ERROR":return"错误";default:return o}};return at(()=>{g()}),(o,t)=>(d(),m("div",Et,[n("header",At,[n("div",Lt,[n("div",Mt,[n("div",Rt,[t[7]||(t[7]=n("h1",{class:"text-2xl font-bold text-gray-900"},"插件管理",-1)),s(e(P),{variant:"outline"},{default:a(()=>[...t[6]||(t[6]=[l("后台管理",-1)])]),_:1})]),n("div",jt,[s(e(f),{variant:"outline",size:"sm",onClick:t[0]||(t[0]=r=>e(i).push("/"))},{default:a(()=>[s(e(_t),{class:"h-4 w-4 mr-2"}),t[8]||(t[8]=l(" 返回首页 ",-1))]),_:1}),s(e(f),{variant:"outline",size:"sm",onClick:tt},{default:a(()=>[s(e(yt),{class:"h-4 w-4 mr-2"}),t[9]||(t[9]=l(" 退出登录 ",-1))]),_:1})])])])]),n("main",Bt,[n("div",zt,[t[12]||(t[12]=n("div",null,[n("h2",{class:"text-lg font-semibold text-gray-900"},"插件列表"),n("p",{class:"text-sm text-gray-500 mt-1"},"管理平台所有插件")],-1)),n("div",Vt,[s(e(f),{onClick:g,variant:"outline",size:"sm"},{default:a(()=>[s(e(ut),{class:"h-4 w-4 mr-2"}),t[10]||(t[10]=l(" 刷新 ",-1))]),_:1}),s(e(f),{onClick:t[1]||(t[1]=r=>A.value=!0)},{default:a(()=>[s(e(wt),{class:"h-4 w-4 mr-2"}),t[11]||(t[11]=l(" 上传插件 ",-1))]),_:1})])]),p.value?(d(),x(e(O),{key:0,class:"p-8"},{default:a(()=>[...t[13]||(t[13]=[n("div",{class:"text-center text-gray-500"},"加载中...",-1)])]),_:1})):j.value?(d(),x(e(q),{key:1,variant:"destructive",class:"mb-6"},{default:a(()=>[s(e(F),null,{default:a(()=>[l(v(j.value),1)]),_:1})]),_:1})):(d(),x(e(O),{key:2},{default:a(()=>[n("div",Ht,[s(e($t),null,{default:a(()=>[s(e(Dt),null,{default:a(()=>[s(e(H),null,{default:a(()=>[s(e(E),{class:"w-[100px]"},{default:a(()=>[...t[14]||(t[14]=[l("ID",-1)])]),_:1}),s(e(E),null,{default:a(()=>[...t[15]||(t[15]=[l("名称",-1)])]),_:1}),s(e(E),{class:"hidden md:table-cell"},{default:a(()=>[...t[16]||(t[16]=[l("版本",-1)])]),_:1}),s(e(E),{class:"hidden lg:table-cell"},{default:a(()=>[...t[17]||(t[17]=[l("作者",-1)])]),_:1}),s(e(E),{class:"hidden sm:table-cell"},{default:a(()=>[...t[18]||(t[18]=[l("状态",-1)])]),_:1}),s(e(E),{class:"text-right"},{default:a(()=>[...t[19]||(t[19]=[l("操作",-1)])]),_:1})]),_:1})]),_:1}),s(e(Ct),null,{default:a(()=>[u.value.length===0?(d(),x(e(H),{key:0},{default:a(()=>[s(e(w),{colspan:"6",class:"text-center text-gray-500 py-8"},{default:a(()=>[...t[20]||(t[20]=[l(" 暂无插件 ",-1)])]),_:1})]),_:1})):R("",!0),(d(!0),m(nt,null,ot(u.value,r=>(d(),x(e(H),{key:r.id},{default:a(()=>[s(e(w),{class:"font-medium"},{default:a(()=>[l(v(r.id),1)]),_:2},1024),s(e(w),null,{default:a(()=>[n("div",null,[n("div",Pt,v(r.name),1),n("div",St,v(r.description),1)])]),_:2},1024),s(e(w),{class:"hidden md:table-cell"},{default:a(()=>[l(v(r.version),1)]),_:2},1024),s(e(w),{class:"hidden lg:table-cell"},{default:a(()=>[l(v(r.author),1)]),_:2},1024),s(e(w),{class:"hidden sm:table-cell"},{default:a(()=>[s(e(P),{variant:et(r.status)},{default:a(()=>[l(v(st(r.status)),1)]),_:2},1032,["variant"])]),_:2},1024),s(e(w),{class:"text-right"},{default:a(()=>[n("div",Tt,[r.status==="DISABLED"||r.status==="LOADED"?(d(),x(e(f),{key:0,size:"sm",variant:"outline",onClick:V=>G(r.id)},{default:a(()=>[s(e(xt),{class:"h-3 w-3 mr-1"}),t[21]||(t[21]=l(" 启用 ",-1))]),_:1},8,["onClick"])):R("",!0),r.status==="ENABLED"?(d(),x(e(f),{key:1,size:"sm",variant:"outline",onClick:V=>K(r.id)},{default:a(()=>[s(e(bt),{class:"h-3 w-3 mr-1"}),t[22]||(t[22]=l(" 禁用 ",-1))]),_:1},8,["onClick"])):R("",!0),s(e(f),{size:"sm",variant:"outline",onClick:V=>Q(r.id)},{default:a(()=>[s(e(ht),{class:"h-3 w-3 mr-1"}),t[23]||(t[23]=l(" 重载 ",-1))]),_:1},8,["onClick"]),s(e(f),{size:"sm",variant:"destructive",onClick:V=>W(r.id)},{default:a(()=>[s(e(gt),{class:"h-3 w-3 mr-1"}),t[24]||(t[24]=l(" 卸载 ",-1))]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),_:1}))]),s(e(S),{open:A.value,"onUpdate:open":t[3]||(t[3]=r=>A.value=r)},{default:a(()=>[s(e(T),null,{default:a(()=>[s(e(I),null,{default:a(()=>[s(e(N),null,{default:a(()=>[...t[25]||(t[25]=[l("上传插件",-1)])]),_:1}),s(e(U),null,{default:a(()=>[...t[26]||(t[26]=[l(" 选择插件 JAR 文件上传并安装 ",-1)])]),_:1})]),_:1}),n("div",It,[n("div",Nt,[n("label",Ut,[n("div",Ot,[t[27]||(t[27]=n("p",{class:"mb-2 text-sm text-gray-500"},[n("span",{class:"font-semibold"},"点击选择文件")],-1)),t[28]||(t[28]=n("p",{class:"text-xs text-gray-500"},"JAR 文件",-1)),b.value?(d(),m("p",qt,v(b.value.name),1)):R("",!0)]),n("input",{id:"file-upload",type:"file",accept:".jar",class:"hidden",onChange:Y},null,32)])]),L.value?(d(),x(e(q),{key:0,variant:"destructive"},{default:a(()=>[s(e(F),null,{default:a(()=>[l(v(L.value),1)]),_:1})]),_:1})):R("",!0)]),s(e(J),null,{default:a(()=>[s(e(f),{variant:"outline",onClick:t[2]||(t[2]=r=>A.value=!1)},{default:a(()=>[...t[29]||(t[29]=[l(" 取消 ",-1)])]),_:1}),s(e(f),{onClick:Z,disabled:!b.value||B.value},{default:a(()=>[B.value?(d(),m("span",Ft,"上传中...")):(d(),m("span",Jt,"上传"))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),s(e(S),{open:M.value,"onUpdate:open":t[5]||(t[5]=r=>M.value=r)},{default:a(()=>[s(e(T),{class:"sm:max-w-md"},{default:a(()=>[s(e(I),null,{default:a(()=>[s(e(N),null,{default:a(()=>[...t[30]||(t[30]=[l("确认卸载",-1)])]),_:1}),s(e(U),null,{default:a(()=>[l(' 确定要卸载插件 "'+v(z.value)+'" 吗？此操作不可恢复。 ',1)]),_:1})]),_:1}),s(e(J),null,{default:a(()=>[s(e(f),{variant:"outline",onClick:t[4]||(t[4]=r=>M.value=!1)},{default:a(()=>[...t[31]||(t[31]=[l(" 取消 ",-1)])]),_:1}),s(e(f),{variant:"destructive",onClick:X},{default:a(()=>[...t[32]||(t[32]=[l(" 确定卸载 ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]))}}),Yt=vt(Gt,[["__scopeId","data-v-5528f4f6"]]);export{Yt as default};
