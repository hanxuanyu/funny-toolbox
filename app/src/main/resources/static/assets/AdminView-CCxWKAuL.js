import{d as y,h as f,n as w,u as e,s as k,o as d,f as l,r as b,k as G,e as s,b as a,m as K,a as v,g as n,t as _,i as T,F as Q,p as W}from"./index-DLC10nSu.js";import{a as X}from"./auth-LxpSchLq.js";import{c as $,f as j,_ as Y,g as Z,R as tt,e as et,a as st,b as at,d as lt,h as nt,i as ot,r as rt,u as dt,j as it}from"./DialogTitle.vue_vue_type_script_setup_true_lang-D_AgGaqL.js";import{e as C,_ as p,c as B,b as R,d as z,a as ut}from"./_plugin-vue_export-helper-C-abHi8m.js";const ct=$("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);const ft=$("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);const mt=$("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);const pt=$("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);const _t=$("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);const vt=$("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);const yt=$("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),ht=y({__name:"DialogFooter",props:{class:{}},setup(c){const u=c;return(i,m)=>(d(),f("div",{"data-slot":"dialog-footer",class:w(e(C)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",u.class))},[k(i.$slots,"default")],2))}}),xt={"data-slot":"table-container",class:"relative w-full overflow-auto"},bt=y({__name:"Table",props:{class:{}},setup(c){const u=c;return(i,m)=>(d(),f("div",xt,[l("table",{"data-slot":"table",class:w(e(C)("w-full caption-bottom text-sm",u.class))},[k(i.$slots,"default")],2)]))}}),gt=y({__name:"TableBody",props:{class:{}},setup(c){const u=c;return(i,m)=>(d(),f("tbody",{"data-slot":"table-body",class:w(e(C)("[&_tr:last-child]:border-0",u.class))},[k(i.$slots,"default")],2))}}),g=y({__name:"TableCell",props:{class:{}},setup(c){const u=c;return(i,m)=>(d(),f("td",{"data-slot":"table-cell",class:w(e(C)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",u.class))},[k(i.$slots,"default")],2))}}),P=y({__name:"TableRow",props:{class:{}},setup(c){const u=c;return(i,m)=>(d(),f("tr",{"data-slot":"table-row",class:w(e(C)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",u.class))},[k(i.$slots,"default")],2))}}),D=y({__name:"TableHead",props:{class:{}},setup(c){const u=c;return(i,m)=>(d(),f("th",{"data-slot":"table-head",class:w(e(C)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",u.class))},[k(i.$slots,"default")],2))}}),wt=y({__name:"TableHeader",props:{class:{}},setup(c){const u=c;return(i,m)=>(d(),f("thead",{"data-slot":"table-header",class:w(e(C)("[&_tr]:border-b",u.class))},[k(i.$slots,"default")],2))}}),kt={class:"min-h-screen bg-gray-50"},$t={class:"bg-white shadow-sm border-b"},Ct={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},Dt={class:"flex justify-between items-center"},Et={class:"flex items-center space-x-4"},At={class:"flex items-center space-x-4"},Tt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Mt={class:"mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},St={class:"flex gap-2"},Lt={class:"overflow-x-auto"},Pt={class:"font-medium"},jt={class:"text-sm text-gray-500 hidden xl:block"},Bt={class:"flex justify-end gap-2"},Rt={class:"space-y-4"},zt={class:"flex items-center justify-center w-full"},Vt={for:"file-upload",class:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100"},It={class:"flex flex-col items-center justify-center pt-5 pb-6"},Ht={key:0,class:"mt-2 text-sm text-gray-700"},Ft={key:0},Nt={key:1},Ut=y({__name:"AdminView",setup(c){const u=K(),i=b([]),m=b(!1),M=b(""),E=b(!1),h=b(null),S=b(!1),A=b(""),x=async()=>{m.value=!0,M.value="";try{const o=await Z();i.value=o.data.data||[]}catch(o){M.value=o.message||"加载插件列表失败"}finally{m.value=!1}},V=async o=>{try{await nt(o),await x()}catch(t){alert(t.message||"启用插件失败")}},I=async o=>{try{await ot(o),await x()}catch(t){alert(t.message||"禁用插件失败")}},H=async o=>{try{await rt(o),await x()}catch(t){alert(t.message||"重新加载插件失败")}},F=async o=>{if(confirm(`确定要卸载插件 ${o} 吗？`))try{await dt(o),await x()}catch(t){alert(t.message||"卸载插件失败")}},N=o=>{const t=o.target;t.files&&t.files.length>0&&(h.value=t.files[0]||null,A.value="")},U=async()=>{if(h.value){S.value=!0,A.value="";try{await it(h.value),E.value=!1,h.value=null,await x()}catch(o){A.value=o.message||"上传插件失败"}finally{S.value=!1}}},q=async()=>{try{await X()}catch{}finally{localStorage.removeItem("isAuthenticated"),u.push("/login")}},O=o=>{switch(o){case"ENABLED":case"STARTED":return"default";case"STOPPED":return"secondary";case"DISABLED":return"outline";case"FAILED":return"destructive";default:return"secondary"}},J=o=>{switch(o){case"ENABLED":case"STARTED":return"运行中";case"STOPPED":return"已停止";case"DISABLED":return"已禁用";case"FAILED":return"失败";default:return o}};return G(()=>{x()}),(o,t)=>(d(),f("div",kt,[l("header",$t,[l("div",Ct,[l("div",Dt,[l("div",Et,[t[5]||(t[5]=l("h1",{class:"text-2xl font-bold text-gray-900"},"插件管理",-1)),s(e(j),{variant:"outline"},{default:a(()=>[...t[4]||(t[4]=[n("后台管理",-1)])]),_:1})]),l("div",At,[s(e(p),{variant:"outline",size:"sm",onClick:t[0]||(t[0]=r=>e(u).push("/"))},{default:a(()=>[s(e(ct),{class:"h-4 w-4 mr-2"}),t[6]||(t[6]=n(" 返回首页 ",-1))]),_:1}),s(e(p),{variant:"outline",size:"sm",onClick:q},{default:a(()=>[s(e(ft),{class:"h-4 w-4 mr-2"}),t[7]||(t[7]=n(" 退出登录 ",-1))]),_:1})])])])]),l("main",Tt,[l("div",Mt,[t[10]||(t[10]=l("div",null,[l("h2",{class:"text-lg font-semibold text-gray-900"},"插件列表"),l("p",{class:"text-sm text-gray-500 mt-1"},"管理平台所有插件")],-1)),l("div",St,[s(e(p),{onClick:x,variant:"outline",size:"sm"},{default:a(()=>[s(e(tt),{class:"h-4 w-4 mr-2"}),t[8]||(t[8]=n(" 刷新 ",-1))]),_:1}),s(e(p),{onClick:t[1]||(t[1]=r=>E.value=!0)},{default:a(()=>[s(e(yt),{class:"h-4 w-4 mr-2"}),t[9]||(t[9]=n(" 上传插件 ",-1))]),_:1})])]),m.value?(d(),v(e(B),{key:0,class:"p-8"},{default:a(()=>[...t[11]||(t[11]=[l("div",{class:"text-center text-gray-500"},"加载中...",-1)])]),_:1})):M.value?(d(),v(e(R),{key:1,variant:"destructive",class:"mb-6"},{default:a(()=>[s(e(z),null,{default:a(()=>[n(_(M.value),1)]),_:1})]),_:1})):(d(),v(e(B),{key:2},{default:a(()=>[l("div",Lt,[s(e(bt),null,{default:a(()=>[s(e(wt),null,{default:a(()=>[s(e(P),null,{default:a(()=>[s(e(D),{class:"w-[100px]"},{default:a(()=>[...t[12]||(t[12]=[n("ID",-1)])]),_:1}),s(e(D),null,{default:a(()=>[...t[13]||(t[13]=[n("名称",-1)])]),_:1}),s(e(D),{class:"hidden md:table-cell"},{default:a(()=>[...t[14]||(t[14]=[n("版本",-1)])]),_:1}),s(e(D),{class:"hidden lg:table-cell"},{default:a(()=>[...t[15]||(t[15]=[n("作者",-1)])]),_:1}),s(e(D),{class:"hidden sm:table-cell"},{default:a(()=>[...t[16]||(t[16]=[n("状态",-1)])]),_:1}),s(e(D),{class:"text-right"},{default:a(()=>[...t[17]||(t[17]=[n("操作",-1)])]),_:1})]),_:1})]),_:1}),s(e(gt),null,{default:a(()=>[i.value.length===0?(d(),v(e(P),{key:0},{default:a(()=>[s(e(g),{colspan:"6",class:"text-center text-gray-500 py-8"},{default:a(()=>[...t[18]||(t[18]=[n(" 暂无插件 ",-1)])]),_:1})]),_:1})):T("",!0),(d(!0),f(Q,null,W(i.value,r=>(d(),v(e(P),{key:r.id},{default:a(()=>[s(e(g),{class:"font-medium"},{default:a(()=>[n(_(r.id),1)]),_:2},1024),s(e(g),null,{default:a(()=>[l("div",null,[l("div",Pt,_(r.name),1),l("div",jt,_(r.description),1)])]),_:2},1024),s(e(g),{class:"hidden md:table-cell"},{default:a(()=>[n(_(r.version),1)]),_:2},1024),s(e(g),{class:"hidden lg:table-cell"},{default:a(()=>[n(_(r.author),1)]),_:2},1024),s(e(g),{class:"hidden sm:table-cell"},{default:a(()=>[s(e(j),{variant:O(r.status)},{default:a(()=>[n(_(J(r.status)),1)]),_:2},1032,["variant"])]),_:2},1024),s(e(g),{class:"text-right"},{default:a(()=>[l("div",Bt,[r.status==="STOPPED"||r.status==="DISABLED"?(d(),v(e(p),{key:0,size:"sm",variant:"outline",onClick:L=>V(r.id)},{default:a(()=>[s(e(mt),{class:"h-3 w-3 mr-1"}),t[19]||(t[19]=n(" 启用 ",-1))]),_:1},8,["onClick"])):T("",!0),r.status==="ENABLED"||r.status==="STARTED"?(d(),v(e(p),{key:1,size:"sm",variant:"outline",onClick:L=>I(r.id)},{default:a(()=>[s(e(_t),{class:"h-3 w-3 mr-1"}),t[20]||(t[20]=n(" 禁用 ",-1))]),_:1},8,["onClick"])):T("",!0),s(e(p),{size:"sm",variant:"outline",onClick:L=>H(r.id)},{default:a(()=>[s(e(pt),{class:"h-3 w-3 mr-1"}),t[21]||(t[21]=n(" 重载 ",-1))]),_:1},8,["onClick"]),s(e(p),{size:"sm",variant:"destructive",onClick:L=>F(r.id)},{default:a(()=>[s(e(vt),{class:"h-3 w-3 mr-1"}),t[22]||(t[22]=n(" 卸载 ",-1))]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),_:1}))]),s(e(Y),{open:E.value,"onUpdate:open":t[3]||(t[3]=r=>E.value=r)},{default:a(()=>[s(e(et),null,{default:a(()=>[s(e(st),null,{default:a(()=>[s(e(at),null,{default:a(()=>[...t[23]||(t[23]=[n("上传插件",-1)])]),_:1}),s(e(lt),null,{default:a(()=>[...t[24]||(t[24]=[n(" 选择插件 JAR 文件上传并安装 ",-1)])]),_:1})]),_:1}),l("div",Rt,[l("div",zt,[l("label",Vt,[l("div",It,[t[25]||(t[25]=l("p",{class:"mb-2 text-sm text-gray-500"},[l("span",{class:"font-semibold"},"点击选择文件")],-1)),t[26]||(t[26]=l("p",{class:"text-xs text-gray-500"},"JAR 文件",-1)),h.value?(d(),f("p",Ht,_(h.value.name),1)):T("",!0)]),l("input",{id:"file-upload",type:"file",accept:".jar",class:"hidden",onChange:N},null,32)])]),A.value?(d(),v(e(R),{key:0,variant:"destructive"},{default:a(()=>[s(e(z),null,{default:a(()=>[n(_(A.value),1)]),_:1})]),_:1})):T("",!0)]),s(e(ht),null,{default:a(()=>[s(e(p),{variant:"outline",onClick:t[2]||(t[2]=r=>E.value=!1)},{default:a(()=>[...t[27]||(t[27]=[n(" 取消 ",-1)])]),_:1}),s(e(p),{onClick:U,disabled:!h.value||S.value},{default:a(()=>[S.value?(d(),f("span",Ft,"上传中...")):(d(),f("span",Nt,"上传"))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]))}}),Kt=ut(Ut,[["__scopeId","data-v-28fc42e3"]]);export{Kt as default};
